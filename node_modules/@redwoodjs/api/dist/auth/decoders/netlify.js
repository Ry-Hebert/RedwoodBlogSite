"use strict";

var _interopRequireDefault = require("@babel/runtime-corejs3/helpers/interopRequireDefault");

var _Object$defineProperty = require("@babel/runtime-corejs3/core-js/object/define-property");

_Object$defineProperty(exports, "__esModule", {
  value: true
});

exports.netlify = void 0;

var _jsonwebtoken = _interopRequireDefault(require("jsonwebtoken"));

const netlify = (token, req) => {
  // Netlify verifies and decodes the JWT before the request is passed to our Serverless
  // function, so the decoded JWT is already available in production.
  if (process.env.NODE_ENV === 'production') {
    const clientContext = req.context.clientContext;
    return (clientContext === null || clientContext === void 0 ? void 0 : clientContext.user) || null;
  } else {
    // We emulate the native Netlify experience in development mode.
    // We just decode it since we don't have the signing key.
    return _jsonwebtoken.default.decode(token);
  }
};

exports.netlify = netlify;